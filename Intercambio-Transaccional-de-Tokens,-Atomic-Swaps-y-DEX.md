>**_Los mercados de tokens ofrecen servicios para aquellos que desean comprar y vender tokens. Actúan como intermediarios de confianza y <span style="text-decoration:underline;">market makers</span> a la vez. Mientras ellos están desempeñando un importante rol en esta nueva era de la   token economy , siguen siendo predominantemente centralizados, lo que los convierte en vulnerables a hackeos, a mala administración, a elevada volatilidad o censura. Los Atomic Swaps y los Exchange Descentralizados (DEX, por su acrónimo en inglés) tratan de mitigar ese riesgo._**

Mientras que la red de blockchain y otras redes de registro distribuido (DLT), permiten transferir los tokens sin intermediarios, ellos solo permiten enviar tokens de una billetera de su red a otra billetera de su red. Un token solo puede ser manejado por un solo tipo de red y no puede naturalmente moverse entre redes por razones de interoperabilidad. Como consecuencia, la compra y venta de tokens, continúa requiriendo del servicio de los mercados de tokens. Muchos mercados online ofrecen estos servicios y actúan como intermediarios de confianza. Ellos se asemejan a los bancos electrónicos que toman los tokens de sus clientes dentro de su custodia y administran el intercambio comercial de dichos tokens entre los usuarios de su plataforma. 

Para los usuarios, el intercambio comercial de un token por otro puede ser dificultoso y consumir tiempo, dependiendo de la popularidad y el estatus legal de un token en particular. Los tokens menos populares y más controvertidos pueden solo ser listados en pequeños Exchange con limitado emparejamiento de tokens, lo que significa que esos usuarios necesitarán (i) registrarse en muchos de esos mercados y (ii) intercambiar tokens muchas veces antes de estar habilitados para comprar el token de su interés. Incluso si muchos tokens están listados en el mismo mercado, el apareamiento de tokens o incluso el emparejamiento de tokens con moneda fiduciaria, es muchas veces limitado. Como resultado de esto, el intercambio comercial de tokens muy a menudo suele consumir mucho tiempo y resulta costoso. A veces, los tokens con “mejor reputación” son listados en un mercado solo para forzar a los usuarios a comercializarlo en ese mercado que de otra manera no hubieran usado. Los compradores potenciales 

Los mercados de tokens tienen el poder de decidir cuándo incluir un token o no. Se han convertido en los “market makers” y en el nuevo guardián de esta economía tokenizada emergente. Por ejemplo, en agosto de 2016, cuando la red de Ethereum ejecutó el tan controvertido “hard fork” como resultado de la explotación de TheDAO[^1], la cadena de Ethereum más corta (“Ethereum Classic”) no tenía ningún valor de mercado. Sin embargo, cuando “Poloniex”, un mercado online, decidió listar el token de “Ethereum Classic” la dinámica de mercado cambio y otros mercados también comenzaron a empezar a listar el token. Si bien no fue la primera vez que se daba un “fork” en una red de blockchain, si fue la primera vez que un token de una cadena minoritaria fue listado en un Exchange confiriendo a la red un valor económico. 

## Desafios de los Exchange Centralizados

Most Exchanges today are centralized Exchanges (CEX) performing intermediary services between buyers and sellers of tokens. They allow simple buying and selling of tokens, also against fiat currencies, and provide easy wallet creation and token management, including the safeguarding of private keys. As opposed to many early crypto enthusiasts, who still manage their tokens with their own wallets (hardware wallet, software wallet, or paper wallet), newcomers often prefer to outsource wallet management to online Exchanges, which act as the custodian of their tokens. Centralized Exchanges operate on classic client-server technology and are not subject to the same security mechanisms of blockchain networks. While they offer important services, they are vulnerable to hacks, mismanagement, volume volatility, or censorship. Hacks and mismanagement have been the biggest issues in the past, especially in the early years, when the market was less mature and unregulated.[ “Mt. Gox](https://en.wikipedia.org/wiki/Mt._Gox),” which was the largest Bitcoin Exchange at the time, suspended trading and filed for bankruptcy in 2014. Due to mismanagement, approximately 850,000 BTC went missing, most likely stolen. Many other cases followed, such as[ “Bitfinex](https://www.coindesk.com/bitfinex-bitcoin-hack-know-dont-know)” or[ “Coincheck](https://fortune.com/2018/01/31/coincheck-hack-how/).” These incidents have led to the misconception in the general public that blockchain networks are not safe.

La mayoría de los mercados de hoy en día están centralizados (CEX, por su acrónimo original en inglés) ejecutando servicios de intermediación entre los compradores y vendedores de tokens. Ellos permiten simplemente que se puedan comprar o vender tokens, a veces incluso contra monedas fiduciarias, y proveen la creación facil de billeteras y administración de tokens, incluyendo la salvaguarda de las llaves privadas.  En oposición a muchos entusiastas tempranos del ecosistema cripto, que continúan manejando sus tokens con sus propias billeteras (“billeteras hardware”, “billeteras software” or “billeteras papel”), los “recién introducidos” prefieren habitualmente delegar la administración de la billetera en los mercados online, que actúan como custodios de sus tokens. Los Exchanges centralizados, operan sobre una base clásica de tecnología “cliente-servidor” y no están sujetos al mismo tipo de mecanismos de seguridad que las redes de blockchain.  Si bien ofrecen servicios importantes, todos ellos son vulnerables a hackeos, deficiente administración, exceso de volatilidad y censura. Los hackeos y la mala administración han sido los mayores problemas en el pasado, especialmente en los años tempranos de este ecosistema, cuando el mercado estaba menos maduro y menos regulado. Mt.Gox, que fue el más grande mercado de Bitcoins para su época, suspendió el intercambio comercial y se registró en bancarrota en 2014. Debido a la mala administración, aproximadamente 850.000 BTC se perdieron, más probablemente se robaron. Muchos otros casos le siguieron, como el de “Bitfinex” o “Coincheck”. Estos incidentes han llevado al prejuicio del público en general de que las redes de blockchain no son seguras. 

Los mercados centralizados muy a menudo no brindan a sus clientes el control total sobre sus llaves privadas, dado que ellos comercializan sobre sus propios registros, situación conocida como “off-chain”. En otras oportunidades, algunos de ellos no poseen billeteras específicas de uso para sus clientes, haciendo una llave privada “inutil”.  Es de esta manera como los clientes ceden el control total sobre sus tokens. Los mercados más pequeños que poseen menos liquidez pueden experimentar volatilidad de precio del tipo de caídas repentinas o picos alcistas vertiginosos, si se diera un repentino cambio en la oferta y la demanda de los tokens. Esto hace que los pequeños mercados, sean objeto de manipulaciones y por consecuencia menos atractivos para los usuarios. Finalmente, los mercados centralizados son también objeto de regulaciones gubernamentales y debe por lo tanto satisfacer las normas de KYC (_“conoce a tu cliente”_, por su acrónimo original en inglés) requeridas cada país, lo que significa que los clientes deben identificarse completamente a sí mismos en el momento de registrarse en el mercado, esto puede aumentar los problemas de privacidad y censura. 

General blockchain interoperability is a solution to the centralization problem, which is currently being addressed by projects such as[ “Cosmos](https://cosmos.network/),” [“Polkadot](https://polkadot.network),” “Wanchain,” “Chainlink,” “Arc,” “Aion,” and “AVA.” Atomic swaps are another solution, with more immediate feasibility.

La interoperabilidad general de blockchain es una solución al problema de centralización, que actualmente está siendo abordado por proyectos tales como “Cosmos”, “Polkadot”, “Wanchain”, “Chainlink”, “Arc”, “Aion”, and “AVA”. Los Atomic Swaps, son otra solución mucho más viable en lo inmediato.  

***
![Atomic Swaps](https://github.com/sherminvo/TokenEconomyBook/blob/main/imgs/24_AtomicSwaps.png)
***


## Atomic Swaps 

Los Atomic Swaps permiten los  intercambios comerciales P2P entre redes diferentes y pueden ser directamente ejecutados entre redes de blockchain separadas, de billetera la billetera, sin necesidad de un tercero intermediario de confianza como en el caso de los mercados. Ellos usan un tipo especial de smart contract llamado “_hash time-locked contract_” (HTLC) para asegurar la transacción del token, haciendo segura para ambas partes que el intercambio del token cumpla con todos los requisitos. HTLCs es una solución similar a la de los canales estatales que se ocupan de la liquidación de pagos “_fuera de la cadena” (_off-chain) a través de un contrato inteligente (read more: Anexo - Soluciones Escalables). Los usuarios mantienen bajo control la totalidad de sus llaves privadas, y sus tokens, cuando realizan este tipo de intercambios.  

Vamos a asumir que Alice y Bob quieren intercambiar tokens desde diferentes redes de blockchain P2P sin ningún intermediario, tal y como podría ser un Exchange. Bob quiere vender sus Bitcoin (BTC) por Litecoin (LTC), y Alice quiere vender sus Litecoin (LTC) por Bitcoin (BTC). Dado que las dos redes no pueden comunicarse directamente, Alice y Bob usan un _“hash time-locked contract” _para bloquear sus tokens por un tiempo predeterminado. Ambos receptores, Bob y Alice, necesitan crear una prueba criptográfica de pago antes de que ese tiempo predeterminado expire. Los tokens son bloqueados vía un esquema de firmas múltiples en un smart contract. El estado del bloqueo de los tokens, se registra en ambas redes. Los tokens solo son intercambiados si ambas llaves privadas (la de cada una de ellos) aparean la transacción. Para depositar sus tokens, Alice primero debe crear un HTLC. Ella crea una llave secreta y genera el hash, desde donde es derivada la dirección del smart contract y a partir del cual está en condiciones de enviar sus tokens. A continuación, ella le envía el hash a Bob, quien puede usarlo para replicar la dirección del smart contract y depositar sus tokens. Alice puede desbloquear los tokens que deposite Bob usando su clave secreta, que dispara un evento donde Bob recibe otra llave secreta para desbloquear los tokens de Alice. Con la transacción ya cerrada, se envía el registro para ser agregado a la blockchain (respectivamente a cada una de las blockchain involucradas en esta operación).  

Los Atomic Swaps requieren que (i) ambas partes del intercambio deban descargar el registro de ambas redes; (ii) ambas redes en las que se vayan a intercambiar los tokens puedan soportar _“hash time-locked contracts” _y empleen la misma función hash criptográfica. Más aún, en aras de producir la transacción de billetera a billetera, (iii) la billetera usada debe también tener la posibilidad de operar Atomic Swaps. 

Si bien los Atomic swaps permiten el intercambio de tokens P2P, no logran resolver el problema de “la coincidencia de deseos”. Solo resultan útiles para personas que saben y conocen de otras personas deseosas de comprar exactamente la misma cantidad de tokens que se ellos desean vender, en el momento exacto en el cual desean hacerlo. La probabilidad de que esto pase entre inversores minoristas es muy baja. Sin embargo, los mercados descentralizados que utilicen Atomic Swaps, podrían resolver ambos problemas. 


## Exchange Descentralizados (DEX - Decentralized Exchanges)

Los mercados descentralizados (DEX por su acronimo en ingles) son aplicaciones descentralizadas que corren en una red de registro distribuido para permitir a los usuarios intercambiar tokens sin la necesidad de una institución que actúe haciendo clearing de las transacciones. El intercambio es ejecutado directamente por el registro (on-chain) y puede potencialmente mitigar muchos de los desafíos que hoy enfrentan los mercados centralizados.  Un mercado totalmente descentralizado  podría hacer uso de los atomic swaps, o métodos similares, con una capa de descubrimiento a agregar que permita realizar transacciones entre dos tenedores de tokens aleatorios quienes no se conozcan entre sí, que podrían vivir en diferentes países y podrían no saber qué es lo que está buscando el otro. Los mercados descentralizados existentes proveen varios niveles de descentralización, muy a menudo, ejecutados sobre una infraestructura parcialmente centralizada y no ofreciendo intercambios de billetera a billetera. Ejemplos actuales son [“Komodo](https://komodoplatform.com/),”[ “WavesDex](https://wavesplatform.com/products-exchange),”[ “OasisDex](https://developer.makerdao.com/oasis/),”[ “Radar Relay](https://radarrelay.com/),” “BarterDex,”[ “Bisq](https://bisq.network/),” “StellarDex,” y [ “EtherDelta](https://etherdelta.com/).”

Muchos de los autoproclamados mercados descentralizados, no son aún completamente descentralizados y están sujetos a muchos desafíos. Debido a los registros de órdenes “on-chain”, suelen ser lentos y costosos, por lo menos hasta que los problemas de escalabilidad de las redes públicas de blockchain se mantengan irresolutos. Cada vez que una orden es subida o modificada, se genera un pico por encima de los costos transaccionales de la red y sobrecarga el registro. Los DEX no son necesariamente “confortables” para los nuevos usuarios del mercado, dado que ellos no resuelven el problema del intercambio comercial de tokens por monedas fiduciarias. Los recién introducidos al mercado de tokens criptográficos, probablemente usarán Exchanges centralizados, que les permiten fácilmente comprar tokens con moneda fiduciaria. Los actuales problemas de usabilidad de las redes descentralizadas contribuyen aún más a la baja liquidez de los tokens como así también al bajo volumen comercializado, que los hace susceptibles de manipulaciones de mercado. Sin embargo, uno de esos desafíos está resuelto, los DEX pueden permitir un mercado más líquido y menos sujeto a manipulaciones, donde la demanda y la oferta pueden existir sin intermediarios arbitrarios. 

For decentralized Exchanges to reach mainstream adoption, we still lack necessary network effects. These network effects rely on when and how general ledger interoperability will be resolved, including resilient cross-chain atomic swaps, interoperability standards, or piggyback solutions like the[ “Pantos](https://pantos.io/)” token. Furthermore, current assets, including fiat currencies, need to be tokenized to catalyze necessary network effects. Decentralized Exchanges will likely come to fruition if and when everyday transactions are predominantly settled using cryptographic tokens and distributed ledgers. We will probably need a mesh of interconnected Exchanges to have enough market depth for global and widespread use of P2P token Exchanges. 

Para que los Exchanges descentralizados lleguen a una adopción convencional, aún seguimos necesitando efectos de red (_network effect). _El Efecto Red, descansa en cuando y cómo la interoperabilidad del registro podrá ser resuelta, incluyendo la resiliencia en atomic swaps entre cadenas (cross-chain), la interoperabilidad estándar, o soluciones a cuestas tales como el token [“Pantos](https://pantos.io/)”. Más aún, los activos actuales, incluyendo las monedas fiduciarias, necesitan para ser tokenizador, catalizar necesariamente el efecto red. Los Exchanges descentralizados podrían probablemente llegar a buen término si y cuando las transacciones diarias sean predominantemente establecidas usando tokens criptográficos y registros distribuidos. Nosotros probablemente enfrentaremos una malla Exchange interconectados para tener suficiente profundidad de mercado para el uso global y generalizado de los Exchange de tokens P2P. 





### Resumen del Capítulo 

> Los tokens sólo pueden ser manejados por su propia red de blockchain y no pueden naturalmente moverse entre redes por razones de interoperabilidad. Los compradores y vendedores de tokens por lo tanto requieren de los servicios de los Exchange de tokens. Estos últimos, se asemejan a los bancos online que toman los tokens de sus clientes bajo su custodia y gestionan el intercambio comercial de tokens entre los usuarios de su plataforma.
 
> La mayoría de los Exchanges de hoy en día son Exchanges centralizados (CEX, por su acrónimo  en inglés) que actúan ofreciendo servicios de intermediación entre compradores y vendedores de tokens. Ellos permiten que un simplemente que puedan comprarse y venderse tokens, inclusive contra monedas fiduciarias, y proveen procedimientos sencillos para la creación de billeteras y administración de tokens, incluyendo la salvaguarda y protección de las claves privadas.  

> Los Exchanges de tokens deben decidir cuándo incluir o no un token. Ellos actúan como intermediarios de confianza y market makers, habiéndose convertido en los nuevos guardianes de esta emergente economía tokenizar. Si bien ellos son jugadores importantes en esta nueva era de la economía del token, siguen siendo predominantemente centralizados, lo que los convierte inevitablemente en vulnerables a hackeos, deficiente administración, elevada volatilidad o censura. Los Atomic Swaps y los Exchanges descentralizados, tratan de mitigar estos riesgos. 

> Atomic Swaps permiten transacciones comerciales P2P entre cadenas y pueden ser directamente ejecutados entre blockchains separadas, de billetera a billetera, sin la necesidad de un tercero de confianza tal y como los Exchange. Estos usan un tipo específico de smart contract, llamado “hash time-locked contract” (HTLC) para asegurar la transacción, haciendo seguro para ambas partes que el intercambio va a satisfacer los requerimientos. 

> Los Atomic Swaps no resuelven el problema de la “coincidencia de deseos”. Ellos solo resultan útiles para personas que se conocen entre sí y tienen la voluntad de intercambiar (comprar y vender) exactamente el mismo monto de tokens en el mismo momento de tiempo. 

> Los Exchanges descentralizados (DEX, por su acrónimo en inglés) son aplicaciones descentralizadas que corren sobre una red de registros distribuidos que permite a los usuarios intercambiar tokens sin la necesidad de una institución que realice las liquidaciones y compensaciones de la operación. El intercambio es asentado directamente en el registro (on-chain). Combinan, Atomic Swaps con algoritmos de coincidencia para mitigar el problema de “la coincidencia de deseos”.  

> Un Exchange completamente descentralizado haría uso de los Atomic Swaps, o métodos similares, con el agregado de una capa de barrido y descubrimiento,  que permita el intercambio comercial entre dos tenedores de tokens aleatorios y desconocidos quienes podrían vivir en diferentes países e incluso no tendrían otra forma de encontrarse uno a otros de no ser por el algoritmo del Exchange.


***

### Referencias del Capítulo y Lectura Complementaria.  

* Borkowski, Michael; McDonald, Daniel; Ritzer, Christoph; Schulte, Stefan: “Towards Atomic Cross-Chain Token Transfers: State of the Art and Open Questions within TAST”, Pantos GmbH Vienna, May 2018, revised version 1.2, August 2018, retrieved from: https://www.dsg.tuwien.ac.at/projects/tast/pub/tast-white-paper-1.pdf
* Gazi Güçlütürk, Osman: “TheDAO Hack explained: Unfortunate take off of smart contracts”, Aug 1, 2018: https://medium.com/@ogucluturk/the-dao-hack-explained-unfortunate-take-off-of-smart-contracts-2bd8c8db3562
* Herlihy, Maurice: “Atomic Cross-Chain Swaps”, May 18, 2018: https://arxiv.org/pdf/1801.09515.pdf
* Higgins, Stan: "The Bitfinex Bitcoin Hack: What We Know (And Don’t Know),” Aug 3, 2016, updated Jun 20, 2018, retrieved from: https://www.coindesk.com/bitfinex-bitcoin-hack-know-dont-know
* Madeira, Antonio: “What Are Atomic Swaps?”, 28 Sep 2017: https://www.cryptocompare.com/coins/guides/what-are-atomic-swaps/
* N.N.: “How to Steal $500 Million in Cryptocurrency,” Fortune Magazine, January 31, 2018, retrieved from: EST https://fortune.com/2018/01/31/coincheck-hack-how/
* N.N.: “What Are Atomic Swaps?”, https://blockgeeks.com/guides/atomic-swaps/
* N.N“.: Komodo White Paper”, https://komodoplatform.com/wp-content/uploads/2018/04/2018-04-04-Komodo-White-Paper-Full.pdf
* N.N.: "5 Predictions for Our Security Token Futur" Coin Crunch, Jun 16, 2018: https://medium.com/hackernoon/5-predictions-for-our-security-token-futur-57ce9cf01256
* Noashh: ”With Atomic Swaps, Komodo Supports 95% Of All Coins In Existence!”, March 16, 2018: https://komodoplatform.com/komodo-now-covers-atomic-swaps-between-95-of-all-coins-in-existence/
* Binance: https://www.binance.com/en
* Bisq: https://bisq.network/
* EtherDelta: https://etherdelta.com/
* Komodo: https://komodoplatform.com/
* Mt. Gox Hack: https://en.wikipedia.org/wiki/Mt._Gox
* OasisDex: https://developer.makerdao.com/oasis/
* Pantos: https://pantos.io/
* Poloniex: https://poloniex.com/
* Radar Relay: https://radarrelay.com/
* WavesDex: https://wavesplatform.com/products-exchange


***

### Notas al pie

[^1]:
Una vulnerabilidad en una de las funciones de los smart contractas, diseñadas para representar los derechos de las minorías, fue explotada y usada para dragar 3.6m Ether del balance de TheDAO (alrededor de 150 millones de USD para aquel entonces). 